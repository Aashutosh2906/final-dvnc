<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DVNC.AI - Da Vinci Innovation System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a1a1a;
            --primary-dark: #000000;
            --secondary: #2a2a2a;
            --tertiary: #666666;
            --quaternary: #999999;
            --background: #FFFFFF;
            --surface: #FAFAFA;
            --border: #E0E0E0;
            --accent: #D4AF37;
            --accent-dark: #B8960F;
            --accent-light: rgba(212, 175, 55, 0.15);
            --accent-lighter: rgba(212, 175, 55, 0.08);
            --success: #27AE60;
            --warning: #F39C12;
            --error: #E74C3C;
            --mechanics: #3498DB;
            --anatomy: #27AE60;
            --optics: #F39C12;
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.04);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 16px 32px rgba(0, 0, 0, 0.12);
            --transition: cubic-bezier(0.4, 0, 0.2, 1);
            --text-primary: #000000;
            --text-secondary: #2a2a2a;
            --text-tertiary: #666666;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-size: 14px;
            line-height: 1.5;
        }

        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }

        .logo-mark {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-dark), var(--accent));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 12px;
            color: white;
            letter-spacing: -0.5px;
        }

        .logo-text {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Sidebar */
        .sidebar {
            width: 320px;
            background: var(--surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            margin-top: 56px;
        }

        .sidebar-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
        }

        .sidebar-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .sidebar-subtitle {
            font-size: 13px;
            color: var(--text-tertiary);
        }

        .prompt-list {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .prompt-item {
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s var(--transition);
            font-size: 13px;
            color: var(--secondary);
            position: relative;
            overflow: hidden;
        }

        .prompt-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--accent-lighter);
            opacity: 0;
            transition: opacity 0.2s var(--transition);
        }

        .prompt-item:hover::before {
            opacity: 1;
        }

        .prompt-item.selected {
            background: var(--accent-light);
            color: var(--accent);
            font-weight: 500;
        }

        .generate-section {
            padding: 16px;
            border-top: 1px solid var(--border);
        }

        .generate-btn {
            width: 100%;
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--accent-dark), var(--accent));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .generate-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #9B7B00, var(--accent-dark));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .generate-btn-icon {
            transition: transform 0.2s var(--transition);
        }

        .generate-btn:hover:not(:disabled) .generate-btn-icon {
            transform: translateX(2px);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-top: 56px;
            background: var(--background);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }

        /* Welcome State with new pulsating design */
        .welcome-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: calc(100vh - 112px);
            animation: fadeIn 0.6s var(--transition);
            overflow: hidden;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero-container {
            width: 100%;
            max-width: 900px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            position: relative;
            height: 100%;
        }

        .tagline {
            color: #999;
            font-size: 0.9em;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 30px;
            text-align: center;
            opacity: 0;
            animation: fadeInDown 1s ease forwards;
        }

        @keyframes fadeInDown {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        .logo-section {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* Main pulsating circle with heartbeat effect */
        .main-circle {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #B8960F, #D4AF37);
            border-radius: 50%;
            margin-bottom: 25px;
            opacity: 0;
            animation: scaleIn 0.8s ease forwards 0.3s, heartbeat 2s ease-in-out infinite 0.8s;
            position: relative;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }

        /* Heartbeat animation from second code */
        @keyframes heartbeat {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            14% {
                transform: scale(1.05);
                opacity: 0.9;
            }
            28% {
                transform: scale(1);
                opacity: 1;
            }
            42% {
                transform: scale(1.08);
                opacity: 0.85;
            }
            70% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Ripple effect for main circle */
        .main-circle::before,
        .main-circle::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 1px solid rgba(212, 175, 55, 0.3);
            transform: translate(-50%, -50%);
            animation: ripple 2s ease-out infinite;
        }

        .main-circle::after {
            animation-delay: 0.3s;
        }

        @keyframes ripple {
            0% {
                width: 100%;
                height: 100%;
                opacity: 0.6;
            }
            100% {
                width: 200%;
                height: 200%;
                opacity: 0;
            }
        }

        @keyframes scaleIn {
            to {
                opacity: 1;
                transform: scale(1);
            }
            from {
                opacity: 0;
                transform: scale(0.5);
            }
        }

        .brand-name {
            font-size: 3em;
            letter-spacing: 10px;
            font-weight: 300;
            margin-bottom: 15px;
            opacity: 0;
            animation: fadeInUp 1s ease forwards 0.5s;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(20px);
            }
        }

        /* New features layout based on second code */
        .features-wrapper {
            position: relative;
            width: 400px;
            height: 140px;
            margin-bottom: 15px;
        }

        .features-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 60px;
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Energy beams - constant visibility */
        .beam-path {
            stroke: #000000;
            stroke-width: 0.5;
            fill: none;
            opacity: 0.15;
            stroke-linecap: round;
        }

        .feature-row {
            display: flex;
            gap: 50px;
            align-items: center;
            z-index: 10;
            position: relative;
        }

        .feature-row-secondary {
            display: flex;
            gap: 50px;
            margin-top: 20px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .feature-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            animation: fadeInScale 0.8s ease forwards;
        }

        .feature-item:nth-child(1) { animation-delay: 0.6s; }
        .feature-item:nth-child(2) { animation-delay: 0.7s; }
        .feature-item:nth-child(3) { animation-delay: 0.8s; }

        @keyframes fadeInScale {
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            from {
                opacity: 0;
                transform: scale(0.9) translateY(10px);
            }
        }

        /* Half-filled circles like in second code */
        .feature-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid #6a6a6a;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .feature-circle:hover {
            transform: scale(1.1);
            border-color: #888;
        }

        .half-fill {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: #5a5a5a;
            transition: height 0.3s ease;
        }

        .feature-circle:hover .half-fill {
            height: 70%;
        }

        .feature-circle-secondary {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid #6a6a6a;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            margin-bottom: 8px;
        }

        .feature-circle-secondary:hover {
            transform: scale(1.08);
            border-color: #888;
        }

        .feature-circle-secondary .half-fill {
            background: #5a5a5a;
            bottom: 0;
            top: auto;
        }

        .feature-text {
            font-size: 0.7em;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: #666;
            text-align: center;
        }

        .input-container {
            width: 100%;
            max-width: 500px;
            position: relative;
            opacity: 0;
            animation: slideUp 1s ease forwards 1.2s;
            margin-top: 20px;
        }

        @keyframes slideUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(30px);
            }
        }

        .ai-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 1px solid #e0e0e0;
            border-radius: 30px;
            font-size: 0.95em;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }

        .ai-input:focus {
            border-color: #333;
            box-shadow: 0 0 0 2px rgba(0,0,0,0.05);
        }

        .ai-input::placeholder {
            color: #aaa;
        }

        .send-button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: black;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-button:hover {
            background: #333;
            transform: translateY(-50%) scale(1.1);
        }

        .send-button:active {
            transform: translateY(-50%) scale(0.95);
        }

        .arrow {
            font-size: 18px;
        }

        /* Message Thread */
        .message-thread {
            background: var(--surface);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-sm);
            animation: slideIn 0.5s var(--transition);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-user {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 32px;
        }

        .message-user-content {
            background: var(--primary);
            color: white;
            padding: 12px 16px;
            border-radius: 16px 16px 4px 16px;
            max-width: 60%;
            font-size: 14px;
        }

        .message-ai {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .ai-section {
            opacity: 0;
            animation: fadeInSection 0.6s var(--transition) forwards;
        }

        @keyframes fadeInSection {
            to {
                opacity: 1;
            }
        }

        /* Process Steps */
        .process-step {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            position: relative;
        }

        .step-indicator {
            width: 32px;
            height: 32px;
            background: var(--background);
            border: 2px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
            transition: all 0.3s var(--transition);
        }

        .step-indicator.active {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
            animation: pulseRing 1.5s var(--transition);
        }

        @keyframes pulseRing {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 102, 255, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(0, 102, 255, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 102, 255, 0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        .step-indicator.mechanics.complete {
            background: var(--mechanics);
            border-color: var(--mechanics);
            color: white;
        }

        .step-indicator.anatomy.complete {
            background: var(--anatomy);
            border-color: var(--anatomy);
            color: white;
        }

        .step-indicator.optics.complete {
            background: var(--optics);
            border-color: var(--optics);
            color: white;
        }

        .step-content {
            flex: 1;
            padding-bottom: 24px;
        }

        .step-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step-status {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 12px;
            background: var(--accent-lighter);
            color: var(--accent);
            animation: blink 1.5s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .step-status.complete {
            background: var(--success);
            color: white;
            animation: none;
        }

        .step-outputs {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .output-item {
            padding: 16px;
            background: var(--background);
            border-radius: 8px;
            border-left: 3px solid var(--border);
            transition: all 0.2s var(--transition);
            opacity: 0;
            animation: slideInOutput 0.5s var(--transition) forwards;
        }

        @keyframes slideInOutput {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .output-item.mechanics {
            border-left-color: var(--mechanics);
        }

        .output-item.anatomy {
            border-left-color: var(--anatomy);
        }

        .output-item.optics {
            border-left-color: var(--optics);
        }

        .output-description {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .output-inspiration {
            font-size: 13px;
            color: var(--tertiary);
            font-style: italic;
            padding-left: 12px;
            border-left: 2px solid var(--border);
        }

        .output-source {
            font-size: 12px;
            color: var(--quaternary);
            margin-top: 4px;
        }

        /* Synthesis Visualization */
        .synthesis-container {
            padding: 32px;
            margin: 32px 0;
            background: linear-gradient(135deg, var(--accent-lighter), transparent);
            border-radius: 16px;
            position: relative;
            opacity: 0;
            animation: fadeInScale 0.8s var(--transition) forwards;
        }

        .synthesis-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .synthesis-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .synthesis-subtitle {
            font-size: 13px;
            color: var(--tertiary);
        }

        .synthesis-visual {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 80px;
            margin: 48px 0;
            position: relative;
        }

        .knowledge-node {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, var(--background), var(--surface));
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            position: relative;
            z-index: 2;
            opacity: 0;
            animation: nodeAppear 0.8s var(--transition) forwards;
        }

        @keyframes nodeAppear {
            from {
                opacity: 0;
                transform: scale(0) rotate(-180deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .knowledge-node.mechanics {
            animation-delay: 0s;
            border: 3px solid var(--mechanics);
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.05), var(--background));
        }

        .knowledge-node.anatomy {
            animation-delay: 0.15s;
            border: 3px solid var(--anatomy);
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.05), var(--background));
        }

        .knowledge-node.optics {
            animation-delay: 0.3s;
            border: 3px solid var(--optics);
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.05), var(--background));
        }

        .node-icon {
            font-size: 24px;
        }

        .node-label {
            font-size: 11px;
            color: var(--tertiary);
            font-weight: 500;
        }

        .synthesis-center {
            position: absolute;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.05));
            border: 2px solid var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 36px;
            opacity: 0;
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.2);
        }

        @keyframes centerExpand {
            from {
                opacity: 0;
                transform: scale(0) rotate(0deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotate(360deg);
            }
        }

        /* Features Grid */
        .features-section {
            margin-top: 32px;
        }

        .features-header {
            font-size: 14px;
            font-weight: 600;
            color: var(--tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 16px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .feature-card {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s var(--transition);
            opacity: 0;
            animation: slideInFeature 0.5s var(--transition) forwards;
        }

        @keyframes slideInFeature {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feature-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .feature-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: var(--surface);
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
            color: var(--tertiary);
            margin-bottom: 12px;
        }

        .feature-description {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 12px;
            color: var(--primary);
        }

        .feature-inspiration {
            font-size: 13px;
            color: var(--tertiary);
            font-style: italic;
            padding: 12px;
            background: var(--surface);
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .feature-metadata {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .development-stage {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stage-concept {
            background: var(--accent-lighter);
            color: var(--accent);
        }

        .stage-prototype {
            background: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .stage-production-ready {
            background: rgba(0, 200, 150, 0.1);
            color: var(--success);
        }

        .engineering-notes {
            font-size: 12px;
            color: var(--quaternary);
            line-height: 1.4;
        }

        /* Final Product - Professional Design */
        .product-section {
            margin-top: 48px;
            padding: 40px;
            background: linear-gradient(135deg, #FFFFFF, #F8F9FA);
            border: 1px solid var(--border);
            border-radius: 16px;
            opacity: 0;
            animation: fadeInProduct 0.8s var(--transition) forwards;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }

        .product-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--mechanics), var(--anatomy), var(--optics), var(--accent));
        }

        @keyframes fadeInProduct {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .product-header {
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }

        .product-name {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
            color: var(--primary);
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .product-market {
            font-size: 14px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .scores-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 32px;
            margin: 32px 0;
            padding: 24px;
            background: var(--surface);
            border-radius: 12px;
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-tertiary);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .score-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 12px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-dark), var(--accent));
            border-radius: 3px;
            transition: width 1.5s var(--transition);
            position: relative;
            overflow: hidden;
        }

        .score-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            100% {
                left: 100%;
            }
        }

        .product-description {
            padding: 32px;
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            line-height: 1.8;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .product-description h3 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-tertiary);
            margin-bottom: 16px;
            font-weight: 600;
        }

        .product-highlights {
            margin-bottom: 24px;
        }

        .product-highlights h4 {
            font-size: 16px;
            color: var(--primary);
            margin-bottom: 16px;
            font-weight: 600;
        }

        .highlight-list {
            list-style: none;
            padding: 0;
        }

        .highlight-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 16px;
            padding-left: 28px;
            position: relative;
        }

        .highlight-item::before {
            content: '◈';
            position: absolute;
            left: 0;
            top: 2px;
            color: var(--accent);
            font-size: 14px;
        }

        .highlight-text {
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .highlight-feature {
            font-weight: 600;
            color: var(--primary);
        }

        .product-summary {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        .summary-text {
            font-size: 15px;
            line-height: 1.7;
            color: var(--text-secondary);
            font-style: italic;
        }

        .principles-list {
            display: flex;
            gap: 12px;
            margin-top: 32px;
            flex-wrap: wrap;
        }

        .principle-tag {
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--accent-lighter), transparent);
            border: 1px solid var(--accent);
            border-radius: 24px;
            font-size: 12px;
            font-weight: 600;
            color: var(--primary);
            transition: all 0.2s var(--transition);
        }

        .principle-tag:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        /* New Chat Button */
        .new-chat-btn {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--accent-dark), var(--accent));
            color: white;
            border: none;
            border-radius: 24px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s var(--transition);
            display: none;
            align-items: center;
            gap: 8px;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .new-chat-btn:hover {
            background: linear-gradient(135deg, #9B7B00, var(--accent-dark));
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(212, 175, 55, 0.4);
        }

        .new-chat-btn.visible {
            display: flex;
        }
        .loading-pulse {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: loadingPulse 1.4s ease-in-out infinite;
        }

        @keyframes loadingPulse {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .loading-pulse:nth-child(2) {
            animation-delay: 0.2s;
            margin-left: 4px;
        }

        .loading-pulse:nth-child(3) {
            animation-delay: 0.4s;
            margin-left: 4px;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--quaternary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .synthesis-visual {
                flex-direction: column;
                gap: 24px;
            }
            
            .features-container {
                flex-direction: column;
                gap: 20px;
            }

            .feature-row {
                flex-direction: column;
                gap: 30px;
            }

            .feature-row-secondary {
                flex-direction: column;
                gap: 30px;
            }

            .brand-name {
                font-size: 2.5em;
                letter-spacing: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <img src="https://static.wixstatic.com/media/33c4b5_158b573e4df145c7856f1330dbd9e49d~mv2.jpg" alt="DVNC.AI" style="height: 36px; width: auto; border-radius: 8px;">
            </div>
            <div class="partner-logo" style="display: flex; align-items: center; gap: 10px;">
                <img src="https://static.wixstatic.com/media/33c4b5_79ea16e09e1b471dae81c5dffb012bb4~mv2.jpeg" alt="TAAMCrypto" style="height: 40px; width: 40px; border-radius: 50%; object-fit: cover;">
                <span style="font-size: 14px; font-weight: 600; color: var(--text-secondary);">TAAMCrypto</span>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">Design Prompts</div>
                <div class="sidebar-subtitle">Select a prompt to begin synthesis</div>
            </div>
            
            <div class="prompt-list" id="promptList"></div>

            <div class="generate-section">
                <button class="generate-btn" id="generateBtn" disabled>
                    <span>Generate Design</span>
                    <span class="generate-btn-icon">→</span>
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="chat-container" id="chatContainer">
                <div class="welcome-state" id="welcomeState">
                    <div class="hero-container">
                        <div class="tagline">Leonardo's Intelligence Reimagined for the 21st Century</div>
                        
                        <div class="logo-section">
                            <div class="main-circle"></div>
                            <div class="brand-name">DVNC.AI</div>
                        </div>
                        
                        <!-- New layout matching second code structure -->
                        <div class="features-wrapper">
                            
                            <div class="features-container">
                                <div class="feature-row">
                                    <div class="feature-item">
                                        <div class="feature-circle">
                                            <div class="half-fill"></div>
                                        </div>
                                        <div class="feature-text">Machine<br>Learning</div>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-circle">
                                            <div class="half-fill"></div>
                                        </div>
                                        <div class="feature-text">Cross-<br>Domain</div>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-circle">
                                            <div class="half-fill"></div>
                                        </div>
                                        <div class="feature-text">Inventive<br>Intelligence</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-row-secondary">
                            <div class="feature-item" style="animation-delay: 0.9s;">
                                <div class="feature-circle-secondary">
                                    <div class="half-fill"></div>
                                </div>
                                <div class="feature-text">Quantum</div>
                            </div>
                            <div class="feature-item" style="animation-delay: 1s;">
                                <div class="feature-circle-secondary">
                                    <div class="half-fill"></div>
                                </div>
                                <div class="feature-text">Neural</div>
                            </div>
                            <div class="feature-item" style="animation-delay: 1.1s;">
                                <div class="feature-circle-secondary">
                                    <div class="half-fill"></div>
                                </div>
                                <div class="feature-text">Golden Ratio</div>
                            </div>
                            <div class="feature-item" style="animation-delay: 1.2s;">
                                <div class="feature-circle-secondary">
                                    <div class="half-fill"></div>
                                </div>
                                <div class="feature-text">Future AI</div>
                            </div>
                        </div>
                        
                        <div class="input-container">
                            <input type="text" class="ai-input" placeholder="Ask DVNC.AI anything">
                            <button class="send-button">
                                <span class="arrow">➤</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- New Chat Button -->
            <button class="new-chat-btn" id="newChatBtn" onclick="startNewChat()">
                <span>↻</span>
                <span>New Chat</span>
            </button>
        </div>
    </div>

    <script>
        const API_URL = '/api/generate';
        
        const prompts = [
            "a next-generation ergonomic computer mouse",
            "an innovative kitchen kettle for urban living",
            "a modular laptop docking station",
            "a patient monitoring device for hospitals",
            "a precision gardening tool system",
            "a sustainable packaging solution for electronics",
            "a smart home lighting system",
            "an eco-friendly water bottle",
            "a wearable fitness tracker",
            "a compact urban bicycle"
        ];

        let selectedPrompt = '';
        let isGenerating = false;

        function initializeUI() {
            const promptList = document.getElementById('promptList');
            
            prompts.forEach((prompt, index) => {
                const promptItem = document.createElement('div');
                promptItem.className = 'prompt-item';
                promptItem.dataset.prompt = prompt;
                promptItem.textContent = prompt;
                promptItem.onclick = () => selectPrompt(prompt, promptItem);
                promptList.appendChild(promptItem);
            });
        }

        function selectPrompt(prompt, element) {
            if (isGenerating) return;
            
            document.querySelectorAll('.prompt-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            element.classList.add('selected');
            selectedPrompt = prompt;
            document.getElementById('generateBtn').disabled = false;
        }

        function createMessageThread(userPrompt) {
            return `
                <div class="message-thread">
                    <div class="message-user">
                        <div class="message-user-content">
                            Design ${userPrompt}
                        </div>
                    </div>
                    <div class="message-ai" id="aiMessage">
                        <!-- AI response will be populated here -->
                    </div>
                </div>
            `;
        }

        function formatSLMOutputs(type, icon, outputs) {
            let outputsHtml = outputs.map((output, idx) => {
                let description = output;
                let inspiration = '';
                let source = '';
                
                if (output.includes('||')) {
                    const parts = output.split('||').map(p => p.trim());
                    description = parts[0];
                    if (parts[1]) inspiration = parts[1];
                    if (parts[2]) source = parts[2].replace('Source:', '').trim();
                }
                
                return `
                    <div class="output-item ${type}" style="animation-delay: ${idx * 0.1}s">
                        <div class="output-description">• ${description}</div>
                        ${inspiration ? `
                            <div class="output-inspiration">
                                "${inspiration}"
                                ${source ? `<div class="output-source">— ${source}</div>` : ''}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            return outputsHtml;
        }

        function formatFeatures(features) {
            return features.map((feature, idx) => `
                <div class="feature-card" style="animation-delay: ${idx * 0.1}s">
                    <div class="feature-number">${idx + 1}</div>
                    <div class="feature-description">${feature.description}</div>
                    <div class="feature-inspiration">
                        "${feature.inspiration}"
                    </div>
                    <div class="feature-metadata">
                        <div class="development-stage stage-${feature.stage.toLowerCase().replace('_', '-')}">
                            ${feature.stage.replace('_', ' ')}
                        </div>
                        <div class="engineering-notes">${feature.notes}</div>
                    </div>
                </div>
            `).join('');
        }

        function formatProduct(data) {
            // Special case for sustainable packaging solution
            if (selectedPrompt === "a sustainable packaging solution for electronics") {
                return `
                    <div class="product-section">
                        <div class="product-header">
                            <div class="product-name">${data.name}</div>
                            <div class="product-market">Target Market: ${data.target_market}</div>
                        </div>
                        
                        <div class="scores-container">
                            <div class="score-item">
                                <div class="score-label">Innovation Score</div>
                                <div class="score-value">${data.innovation_score}/10</div>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${data.innovation_score * 10}%"></div>
                                </div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Feasibility Score</div>
                                <div class="score-value">${data.feasibility_score}/10</div>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${data.feasibility_score * 10}%"></div>
                                </div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Market Viability</div>
                                <div class="score-value">${(data.viability_score * 100).toFixed(0)}%</div>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${data.viability_score * 100}%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="product-description">
                            <h3>Final Product Design</h3>
                            
                            <div class="product-highlights">
                                <p class="summary-text" style="font-style: italic; margin-bottom: 20px;">
                                    As I once studied the mechanics of flight to understand the bird, today's designers must study the mechanics of protection to understand sustainable packaging. The principles remain eternal—only the canvas has changed from parchment to pixels, from pigment to polymer.
                                </p>
                                
                                <ul class="highlight-list">
                                    <li class="highlight-item">
                                        <div class="highlight-text">
                                            <span class="highlight-feature">Golden Ratio Integration: The Mathematics of Visual Harmony</span><br>
                                            Your users' eyes still follow the same proportional relationships I mapped centuries ago. Apply the 1.618 ratio not as decoration, but as foundational architecture—packaging dimensions, interface proportions, even the rhythm of your unboxing experience. This isn't aesthetic theory; it's cognitive science disguised as mathematics. 
                                            <em style="color: var(--text-tertiary);">Status: Conceptual—validate through A/B testing and user eye-tracking studies.</em>
                                        </div>
                                    </li>
                                    
                                    <li class="highlight-item">
                                        <div class="highlight-text">
                                            <span class="highlight-feature">Shadow-Forward Design: Negative Space as Functional Element</span><br>
                                            What I learned painting faces, you must learn designing experiences: shadows define form more powerfully than highlights. Use recessed surfaces, strategic voids, and material transparency not just for protection, but for intuitive user guidance. The empty spaces tell users where to grip, how to open, what to expect. 
                                            <em style="color: var(--text-tertiary);">Status: Production-ready—implement through established molding and cutting processes.</em>
                                        </div>
                                    </li>
                                    
                                    <li class="highlight-item">
                                        <div class="highlight-text">
                                            <span class="highlight-feature">Dynamic Responsiveness: Motion as User Experience</span><br>
                                            I wrote "motion is the cause of every life" while studying anatomy. Your packaging should embody this—materials that respond to pressure, structures that guide movement, systems that adapt to different product configurations. Think origami meets engineering meets user psychology. 
                                            <em style="color: var(--text-tertiary);">Status: Prototype phase—iterate based on user interaction data.</em>
                                        </div>
                                    </li>
                                    
                                    <li class="highlight-item">
                                        <div class="highlight-text">
                                            <span class="highlight-feature">Structural Biomimicry: Engineering Lessons from Nature's Archive</span><br>
                                            The hexagonal efficiency of honeycomb, the load distribution of tree branches, the shock absorption of human joints—these aren't just inspiration, they're proven engineering solutions waiting for industrial application. Apply these geometries to reduce material usage while increasing protective performance. 
                                            <em style="color: var(--text-tertiary);">Status: Production-ready—leverage existing manufacturing capabilities.</em>
                                        </div>
                                    </li>
                                    
                                    <li class="highlight-item">
                                        <div class="highlight-text">
                                            <span class="highlight-feature">Ergonomic Intelligence: The Hand-Brain Connection</span><br>
                                            I studied human anatomy to understand how bodies move through space. Today's packaging must understand how fingers navigate interfaces, how hands process tactile information, how the brain interprets physical feedback. Design for the conversation between user and object. 
                                            <em style="color: var(--text-tertiary);">Status: Conceptual—requires extensive user research and haptic testing.</em>
                                        </div>
                                    </li>
                                    
                                    <li class="highlight-item">
                                        <div class="highlight-text">
                                            <span class="highlight-feature">Precision Through Mathematical Constraints: Systems Thinking</span><br>
                                            My engineering notebooks were filled with calculations because beauty without function is merely decoration. Your sustainable solutions must balance material science, manufacturing economics, user psychology, and environmental impact through rigorous mathematical optimization. Constraint breeds innovation. 
                                            <em style="color: var(--text-tertiary);">Status: Conceptual—develop through iterative modeling and lifecycle analysis.</em>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            
                            <div class="product-summary">
                                <h4 style="font-size: 16px; color: var(--primary); margin-bottom: 16px; font-weight: 600;">The Modern Synthesis</h4>
                                <p class="summary-text">
                                    This approach achieves ${(data.viability_score * 100).toFixed(0)}% market viability not through compromise, but through the systematic application of timeless principles to contemporary challenges. Innovation score of ${data.innovation_score}/10 reflects not incremental improvement, but paradigm integration—where Renaissance humanism meets data-driven design methodology.
                                </p>
                                <p class="summary-text" style="margin-top: 16px;">
                                    The designer who understands that a user's first touch of packaging creates the same neurological response as a viewer's first glimpse of the Mona Lisa will create solutions that transcend mere functionality. They will craft experiences that feel inevitable, necessary, and somehow always meant to be.
                                </p>
                                <p class="summary-text" style="margin-top: 20px; font-style: italic; font-weight: 600;">
                                    Study the old masters. Ship the new solutions. The future belongs to those who can synthesize across centuries.
                                </p>
                            </div>
                        </div>
                        
                        <div class="principles-list">
                            <div class="principle-tag">⚙ Mechanics & Physics</div>
                            <div class="principle-tag">🦋 Anatomy & Biology</div>
                            <div class="principle-tag">👁 Optics & Aesthetics</div>
                        </div>
                    </div>
                `;
            }
            
            // Default formatting for all other prompts
            const featuresList = data.features.map(feat => {
                // Remove source part from inspiration (everything after ||)
                const inspirationOnly = feat.inspiration.split('||')[0].trim();
                return `
                    <li class="highlight-item">
                        <div class="highlight-text">
                            <span class="highlight-feature">${feat.description}</span> - 
                            Inspired by "${inspirationOnly}", this feature is currently at 
                            ${feat.stage.toLowerCase().replace('_', ' ')} stage. ${feat.notes}.
                        </div>
                    </li>
                `;
            }).join('');

            return `
                <div class="product-section">
                    <div class="product-header">
                        <div class="product-name">${data.name}</div>
                        <div class="product-market">Target Market: ${data.target_market}</div>
                    </div>
                    
                    <div class="scores-container">
                        <div class="score-item">
                            <div class="score-label">Innovation Score</div>
                            <div class="score-value">${data.innovation_score}/10</div>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${data.innovation_score * 10}%"></div>
                            </div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">Feasibility Score</div>
                            <div class="score-value">${data.feasibility_score}/10</div>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${data.feasibility_score * 10}%"></div>
                            </div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">Market Viability</div>
                            <div class="score-value">${(data.viability_score * 100).toFixed(0)}%</div>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${data.viability_score * 100}%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="product-description">
                        <h3>Final Product Design</h3>
                        
                        <div class="product-highlights">
                            <h4>${data.name} - Revolutionary ${data.product_type}</h4>
                            <ul class="highlight-list">
                                ${featuresList}
                            </ul>
                        </div>
                        
                        <div class="product-summary">
                            <p class="summary-text">
                                The ${data.name} represents a paradigm shift in ${data.product_type} design, 
                                seamlessly integrating mechanical precision, biological inspiration, and aesthetic elegance. 
                                With an innovation score of ${data.innovation_score}/10 and feasibility rating of 
                                ${data.feasibility_score}/10, this design achieves a remarkable ${(data.viability_score * 100).toFixed(0)}% 
                                market viability, embodying the Renaissance ideal of perfect harmony between form and function.
                            </p>
                        </div>
                    </div>
                    
                    <div class="principles-list">
                        <div class="principle-tag">⚙ Mechanics & Physics</div>
                        <div class="principle-tag">🦋 Anatomy & Biology</div>
                        <div class="principle-tag">👁 Optics & Aesthetics</div>
                    </div>
                </div>
            `;
        }

        function startNewChat() {
            // Reload the page to return to homepage
            window.location.reload();
        }

        async function generateDesign() {
            if (!selectedPrompt || isGenerating) return;
            
            isGenerating = true;
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            
            const chatContainer = document.getElementById('chatContainer');
            const welcomeState = document.getElementById('welcomeState');
            if (welcomeState) welcomeState.remove();
            
            // Show the New Chat button
            document.getElementById('newChatBtn').classList.add('visible');
            
            chatContainer.innerHTML = createMessageThread(selectedPrompt);
            const aiMessage = document.getElementById('aiMessage');
            
            // Create the unified AI response structure
            let responseHTML = `
                <div class="ai-section" style="animation-delay: 0s">
                    <div class="step-title">
                        Initializing Da Vinci Knowledge Synthesis
                        <span class="step-status" id="initStatus">Processing</span>
                    </div>
                </div>
                
                <div class="process-step" id="mechanicsStep">
                    <div class="step-indicator mechanics" id="mechanicsIndicator">⚙</div>
                    <div class="step-content">
                        <div class="step-title">
                            Mechanics & Physics SLM
                            <span class="step-status" id="mechanicsStatus" style="display: none">Processing</span>
                        </div>
                        <div class="step-outputs" id="mechanicsOutputs"></div>
                    </div>
                </div>
                
                <div class="process-step" id="anatomyStep">
                    <div class="step-indicator anatomy" id="anatomyIndicator">🦋</div>
                    <div class="step-content">
                        <div class="step-title">
                            Anatomy & Biology SLM
                            <span class="step-status" id="anatomyStatus" style="display: none">Processing</span>
                        </div>
                        <div class="step-outputs" id="anatomyOutputs"></div>
                    </div>
                </div>
                
                <div class="process-step" id="opticsStep">
                    <div class="step-indicator optics" id="opticsIndicator">👁</div>
                    <div class="step-content">
                        <div class="step-title">
                            Optics & Aesthetics SLM
                            <span class="step-status" id="opticsStatus" style="display: none">Processing</span>
                        </div>
                        <div class="step-outputs" id="opticsOutputs"></div>
                    </div>
                </div>
                
                <div id="synthesisSection"></div>
                <div id="featuresSection"></div>
                <div id="productSection"></div>
            `;
            
            aiMessage.innerHTML = responseHTML;
            
            try {
                // Simulate initialization
                await new Promise(resolve => setTimeout(resolve, 1000));
                document.getElementById('initStatus').textContent = 'Complete';
                document.getElementById('initStatus').classList.add('complete');
                
                // Make API call or use mock data
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: selectedPrompt })
                }).catch(() => null);
                
                const data = response && response.ok ? await response.json() : getMockData();
                
                // Process each SLM sequentially
                await processSLM('mechanics', '⚙', data.slm_outputs.mechanics);
                await processSLM('anatomy', '🦋', data.slm_outputs.anatomy);
                await processSLM('optics', '👁', data.slm_outputs.optics);
                
                // Enhanced synthesis animation with converging nodes
                await new Promise(resolve => setTimeout(resolve, 500));
                document.getElementById('synthesisSection').innerHTML = `
                    <div class="synthesis-container" id="synthesisContainer">
                        <div class="synthesis-header">
                            <div class="synthesis-title">Da Vinci Abstraction Organ</div>
                            <div class="synthesis-subtitle">Synthesizing knowledge domains...</div>
                        </div>
                        <div class="synthesis-visual" id="synthesisVisual">
                            <div class="knowledge-node mechanics" id="nodeMechanics">
                                <div class="node-icon">⚙</div>
                                <div class="node-label">Mechanics</div>
                            </div>
                            <div class="knowledge-node anatomy" id="nodeAnatomy">
                                <div class="node-icon">🦋</div>
                                <div class="node-label">Anatomy</div>
                            </div>
                            <div class="knowledge-node optics" id="nodeOptics">
                                <div class="node-icon">👁</div>
                                <div class="node-label">Optics</div>
                            </div>
                            <div class="synthesis-center" id="synthesisCenter">◈</div>
                        </div>
                    </div>
                `;
                
                // Auto-scroll to synthesis section
                document.getElementById('synthesisContainer').scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Wait for nodes to appear
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Start converging animation
                const nodeMechanics = document.getElementById('nodeMechanics');
                const nodeAnatomy = document.getElementById('nodeAnatomy');
                const nodeOptics = document.getElementById('nodeOptics');
                const synthesisCenter = document.getElementById('synthesisCenter');
                const synthesisVisual = document.getElementById('synthesisVisual');
                
                // Add inline styles for convergence animation
                nodeMechanics.style.transition = 'transform 1s cubic-bezier(0.4, 0, 0.2, 1)';
                nodeAnatomy.style.transition = 'transform 1s cubic-bezier(0.4, 0, 0.2, 1)';
                nodeOptics.style.transition = 'transform 1s cubic-bezier(0.4, 0, 0.2, 1)';
                
                // Move nodes toward center with equal importance
                await new Promise(resolve => setTimeout(resolve, 200));
                nodeMechanics.style.transform = 'translateX(60px) scale(0.95)';
                nodeAnatomy.style.transform = 'translateX(0px) scale(0.95)';
                nodeOptics.style.transform = 'translateX(-60px) scale(0.95)';
                
                // Wait for nodes to converge
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Show synthesis center expanding with pulse
                synthesisCenter.style.animation = 'centerExpand 1s cubic-bezier(0.4, 0, 0.2, 1) forwards, pulse 0.6s ease-out 1s 3';
                
                // Wait for center to fully expand
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Transform synthesis visual to show it's creating the features
                synthesisVisual.style.transition = 'transform 0.8s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.8s ease-out';
                synthesisVisual.style.transform = 'scale(0.8) translateY(-20px)';
                synthesisVisual.style.opacity = '0.7';
                
                // Features section (initially hidden)
                document.getElementById('featuresSection').innerHTML = `
                    <div class="features-section" id="featuresDiv" style="opacity: 0; transform: translateY(30px);">
                        <div class="features-header">Synthesized Design Features</div>
                        <div class="features-grid">
                            ${formatFeatures(data.features)}
                        </div>
                    </div>
                `;
                
                // Start the transformation
                const synthesisContainer = document.getElementById('synthesisContainer');
                const featuresDiv = document.getElementById('featuresDiv');
                
                // Wait a moment before transformation
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Create arrow or flow indicator
                const flowIndicator = document.createElement('div');
                flowIndicator.style.cssText = `
                    text-align: center;
                    font-size: 24px;
                    color: var(--accent);
                    margin: 20px 0;
                    opacity: 0;
                    animation: fadeIn 0.5s ease-out forwards;
                `;
                flowIndicator.innerHTML = '↓';
                synthesisContainer.parentNode.insertBefore(flowIndicator, synthesisContainer.nextSibling);
                
                // Auto-scroll to features section
                featuresDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Animate features appearing from synthesis
                featuresDiv.style.transition = 'opacity 1s ease-out, transform 1s cubic-bezier(0.4, 0, 0.2, 1)';
                await new Promise(resolve => setTimeout(resolve, 100));
                featuresDiv.style.opacity = '1';
                featuresDiv.style.transform = 'translateY(0)';
                
                // Wait for features to fully appear
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Auto-scroll to final product section
                document.getElementById('productSection').innerHTML = formatProduct(data);
                document.getElementById('productSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
                
            } catch (error) {
                console.error('Error:', error);
            } finally {
                isGenerating = false;
                generateBtn.disabled = false;
            }
        }

        async function processSLM(type, icon, outputs) {
            const indicator = document.getElementById(`${type}Indicator`);
            const status = document.getElementById(`${type}Status`);
            const outputsContainer = document.getElementById(`${type}Outputs`);
            
            indicator.classList.add('active');
            status.style.display = 'inline-block';
            
            // Auto-scroll to this section
            const step = document.getElementById(`${type}Step`);
            if (step) {
                step.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            outputsContainer.innerHTML = formatSLMOutputs(type, icon, outputs);
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            indicator.classList.remove('active');
            indicator.classList.add('complete');
            status.textContent = 'Complete';
            status.classList.add('complete');
        }

        function getMockData() {
            return {
                name: `Vitruvian ${['Harmony', 'Flow', 'Aero', 'Sfumato'][Math.floor(Math.random() * 4)]} ${selectedPrompt.split(' ').slice(-1)[0]}`,
                product_type: selectedPrompt,
                target_market: ['Consumer Electronics', 'Industrial Equipment', 'Medical Devices', 'Sustainable Goods'][Math.floor(Math.random() * 4)],
                innovation_score: Math.floor(Math.random() * 3) + 7,
                feasibility_score: Math.floor(Math.random() * 3) + 7,
                viability_score: (Math.random() * 0.3 + 0.7).toFixed(2),
                features: [
                    {
                        description: "Apply pyramidal law of force to enhance mechanical efficiency and durability",
                        inspiration: "Pyramidal law of force: power diminishes towards its end",
                        stage: "PROTOTYPE",
                        notes: "Prototype feasible with current technology"
                    },
                    {
                        description: "Incorporate proportional harmony based on the Vitruvian system for ergonomic design",
                        inspiration: "Proportional harmony based on the Vitruvian system",
                        stage: "PRODUCTION_READY",
                        notes: "Production-ready using established processes"
                    },
                    {
                        description: "Integrate sfumato technique for visual harmony and perceptual depth",
                        inspiration: "Sfumato: do not make definite boundaries",
                        stage: "CONCEPT",
                        notes: "Conceptual exploration requires validation"
                    }
                ],
                slm_outputs: {
                    mechanics: [
                        "Apply pyramidal law of force to enhance mechanical efficiency || Pyramidal law of force: power diminishes towards its end || Source: Madrid I, 16r",
                        "Use water flow principles for efficient energy distribution || Water seeks the most efficient path || Source: Codex Leicester"
                    ],
                    anatomy: [
                        "Incorporate Vitruvian proportions for optimal ergonomics || Proportional harmony based on the Vitruvian system || Source: Venice Accademia",
                        "Apply layered system integration mimicking biological structures || Layered system integration || Source: Anatomical drawings"
                    ],
                    optics: [
                        "Integrate sfumato gradients for perceptual depth || Sfumato: do not make definite boundaries || Source: Ash.II, 14v",
                        "Apply golden ratio for aesthetic harmony || Golden ratio in natural designs || Source: Divine Proportion"
                    ]
                }
            };
        }

        document.getElementById('generateBtn').addEventListener('click', generateDesign);
        initializeUI();
    </script>
</body>
</html>
